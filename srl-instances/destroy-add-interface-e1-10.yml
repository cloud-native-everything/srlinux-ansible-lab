---
# Adding ethernet-1/10 interface
#
    - name: get list of srl leaf instances
      command: ip netns | grep leaf
      register: leaf_inst
      changed_when: False

    - name: DELETE interface ethernet-1/10 to mac-vrf1
      command: 
      cmd: gnmic set --tls-ca rootCA.crt --tls-cert client.crt --tls-key client_key.pem -a {{ item }}:57400 --username admin --password admin -e json_ietf --skip-verify --delete /network-instance[name=mac-vrf1]/interface[name=ethernet-1/10.0] 
        chdir: /tmp
      with_items: "{{ leaf_inst }}"

    - name: DELETE interface ethernet-1/10 to leaf
      command: 
      cmd: gnmic set --tls-ca rootCA.crt --tls-cert client.crt --tls-key client_key.pem -a {{ item }}:57400 --username admin --password admin -e json_ietf --skip-verify --delete /interface[name=ethernet-1/10]
        chdir: /tmp
      with_items: "{{ leaf_inst }}"

    - name: DELETE JSON and CERT files
      file:
        path: "/tmp/{{ item }}"
        state: absent
      with_items: 
        - 'client.crt'
        - 'client_key.pem'
        - 'rootCA.crt' 
        - 'mac-vrf1-add-interface-e10.json'
        - 'ethernet-10.json'
